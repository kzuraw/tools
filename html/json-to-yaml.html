<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>JSON to YAML Converter</title>
  <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üõ†Ô∏è</text></svg>">
  <style>
* {
  box-sizing: border-box;
}

body {
  margin: 0;
  padding: 20px;
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
  background: #f5f5f7;
  color: #1d1d1f;
}

.container {
  max-width: 1200px;
  margin: 0 auto;
}

h1 {
  font-size: 32px;
  font-weight: 600;
  margin: 0 0 32px 0;
  text-align: center;
}

.converter {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 20px;
  margin-bottom: 20px;
}

.panel {
  background: white;
  border-radius: 12px;
  padding: 20px;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
}

.panel h2 {
  font-size: 18px;
  font-weight: 600;
  margin: 0 0 12px 0;
  color: #1d1d1f;
}

textarea {
  width: 100%;
  height: 400px;
  padding: 12px;
  border: 1px solid #d2d2d7;
  border-radius: 8px;
  font-family: 'SF Mono', Monaco, 'Courier New', monospace;
  font-size: 16px;
  resize: vertical;
  outline: none;
  transition: border-color 0.2s;
}

textarea:focus {
  border-color: #0066cc;
}

.button-group {
  display: flex;
  gap: 12px;
  justify-content: center;
}

button {
  padding: 12px 24px;
  background: #0066cc;
  color: white;
  border: none;
  border-radius: 8px;
  font-size: 16px;
  font-weight: 500;
  cursor: pointer;
  transition: background 0.2s;
}

button:hover {
  background: #0055b3;
}

button:active {
  background: #004999;
}

button.secondary {
  background: #f5f5f7;
  color: #1d1d1f;
}

button.secondary:hover {
  background: #e8e8ed;
}

.error {
  color: #ff3b30;
  font-size: 14px;
  margin-top: 8px;
  display: none;
}

.error.show {
  display: block;
}

footer {
  margin-top: 40px;
  padding-top: 20px;
  text-align: center;
  color: #666;
  font-size: 14px;
}

footer a {
  color: #0066cc;
  text-decoration: none;
  margin: 0 10px;
}

footer a:hover {
  text-decoration: underline;
}

@media (max-width: 768px) {
  .converter {
    grid-template-columns: 1fr;
  }
}
  </style>
</head>
<body>
  <div class="container">
    <h1>JSON to YAML Converter</h1>

    <div class="converter">
      <div class="panel">
        <h2>JSON Input</h2>
        <textarea id="jsonInput" placeholder="Paste your JSON here..."></textarea>
        <div class="error" id="jsonError"></div>
      </div>

      <div class="panel">
        <h2>YAML Output</h2>
        <textarea id="yamlOutput" readonly placeholder="YAML will appear here..."></textarea>
      </div>
    </div>

    <div class="button-group">
      <button id="convertBtn">Convert to YAML</button>
      <button id="copyBtn" class="secondary">Copy YAML</button>
      <button id="clearBtn" class="secondary">Clear</button>
    </div>
  </div>

  <script type="module">
const jsonInput = document.getElementById('jsonInput');
const yamlOutput = document.getElementById('yamlOutput');
const jsonError = document.getElementById('jsonError');
const convertBtn = document.getElementById('convertBtn');
const copyBtn = document.getElementById('copyBtn');
const clearBtn = document.getElementById('clearBtn');

function jsonToYaml(obj, indent = 0) {
  const spaces = '  '.repeat(indent);
  let yaml = '';

  if (Array.isArray(obj)) {
    obj.forEach(item => {
      if (typeof item === 'object' && item !== null) {
        yaml += `${spaces}-\n${jsonToYaml(item, indent + 1)}`;
      } else {
        yaml += `${spaces}- ${formatValue(item)}\n`;
      }
    });
  } else if (typeof obj === 'object' && obj !== null) {
    Object.entries(obj).forEach(([key, value]) => {
      const safeKey = /^[a-zA-Z0-9_-]+$/.test(key) ? key : `"${key}"`;

      if (Array.isArray(value)) {
        if (value.length === 0) {
          yaml += `${spaces}${safeKey}: []\n`;
        } else if (value.every(v => typeof v !== 'object')) {
          yaml += `${spaces}${safeKey}:\n${jsonToYaml(value, indent + 1)}`;
        } else {
          yaml += `${spaces}${safeKey}:\n${jsonToYaml(value, indent + 1)}`;
        }
      } else if (typeof value === 'object' && value !== null) {
        yaml += `${spaces}${safeKey}:\n${jsonToYaml(value, indent + 1)}`;
      } else {
        yaml += `${spaces}${safeKey}: ${formatValue(value)}\n`;
      }
    });
  }

  return yaml;
}

function formatValue(value) {
  if (value === null) return 'null';
  if (typeof value === 'boolean') return value.toString();
  if (typeof value === 'number') return value.toString();
  if (typeof value === 'string') {
    if (/[\n:]/.test(value) || value.includes('#')) {
      return `"${value.replace(/"/g, '\\"')}"`;
    }
    return value;
  }
  return String(value);
}

function convert() {
  const input = jsonInput.value.trim();

  if (!input) {
    jsonError.textContent = '';
    jsonError.classList.remove('show');
    yamlOutput.value = '';
    return;
  }

  try {
    const parsed = JSON.parse(input);
    const yaml = jsonToYaml(parsed);
    yamlOutput.value = yaml.trim();
    jsonError.textContent = '';
    jsonError.classList.remove('show');
  } catch (e) {
    jsonError.textContent = `Invalid JSON: ${e.message}`;
    jsonError.classList.add('show');
    yamlOutput.value = '';
  }
}

jsonInput.addEventListener('input', convert);
convertBtn.addEventListener('click', convert);

copyBtn.addEventListener('click', async () => {
  if (yamlOutput.value) {
    await navigator.clipboard.writeText(yamlOutput.value);
    const originalText = copyBtn.textContent;
    copyBtn.textContent = 'Copied!';
    setTimeout(() => {
      copyBtn.textContent = originalText;
    }, 2000);
  }
});

clearBtn.addEventListener('click', () => {
  jsonInput.value = '';
  yamlOutput.value = '';
  jsonError.textContent = '';
  jsonError.classList.remove('show');
});
  </script>

  <footer>
    <a href="../index.html">Home</a> |
    <a href="https://github.com/kzuraw/tools">Source Code</a> |
    <a href="https://kzuraw.com">kzuraw.com</a>
  </footer>
</body>
</html>
